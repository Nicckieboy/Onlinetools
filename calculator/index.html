<!doctype html>
<html lang="en">
<head>
  <link rel="canonical" href="https://simpletoolsweb.com/calculator/" />
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Web Calculator | Simple Tools Web</title>

  <!-- SEO -->
  <meta name="description" content="Free online calculator for everyday use. Supports keyboard input, percentage, decimals, and continuous calculations. No sign-up." />
  <style>
    :root {
      --bg:#0b1220;
      --panel:#111b2e;
      --key:#1a2a45;
      --key2:#243a61;
      --accent:#3b82f6;
      --text:#e5e7eb;
      --muted:#9ca3af;
    }
    * {
      box-sizing: border-box;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
    }
    body {
      margin:0;
      min-height:100svh;
      display:grid;
      place-items:center;
      background: radial-gradient(1200px 600px at 30% 10%, #162445, var(--bg));
      color:var(--text);
    }
    .wrap { width:min(420px, 92vw); }
    .card {
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border:1px solid rgba(255,255,255,.1);
      border-radius:18px;
      overflow:hidden;
      box-shadow: 0 20px 60px rgba(0,0,0,.35);
    }
    header {
      padding:14px 16px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      background: rgba(0,0,0,.12);
    }
    header .title { font-weight:700; letter-spacing:.02em; }
    header .hint { font-size:12px; color:var(--muted); }

    .display {
      padding:16px;
      background: rgba(0,0,0,.14);
    }
    .expression {
      min-height:20px;
      font-size:14px;
      color:var(--muted);
      word-break: break-all;
    }
    .value {
      margin-top:6px;
      font-size:38px;
      font-weight:700;
      text-align:right;
      overflow:hidden;
      text-overflow:ellipsis;
      white-space:nowrap;
    }

    .keys {
      display:grid;
      grid-template-columns: repeat(4, 1fr);
      gap:10px;
      padding:14px;
      background: rgba(0,0,0,.06);
    }
    button {
      border:0;
      border-radius:14px;
      padding:14px 10px;
      font-size:18px;
      font-weight:650;
      color:var(--text);
      background: var(--key);
      cursor:pointer;
      transition: transform .04s ease, filter .15s ease;
      box-shadow: inset 0 1px 0 rgba(255,255,255,.08);
      user-select:none;
      -webkit-tap-highlight-color: transparent;
      touch-action: manipulation;
    }
    button:active { transform: translateY(1px); filter: brightness(1.08); }
    .op { background: var(--key2); }
    .accent {
      background: linear-gradient(180deg, rgba(59,130,246,.95), rgba(59,130,246,.75));
    }
    .wide { grid-column: span 2; }

    footer {
      padding:10px 16px 14px;
      font-size:12px;
      color:var(--muted);
      text-align:center;
    }

    /* --- Info panel (below keys, above footer) --- */
    .info{
      margin: 0 14px 12px;
      padding: 12px 12px;
      border: 1px solid rgba(255,255,255,.10);
      border-radius: 16px;
      background: rgba(0,0,0,.10);
    }
    .infoTitle{
      margin: 0 0 6px;
      font-size: 14px;
      font-weight: 800;
      letter-spacing: .01em;
      color: var(--text);
    }
    .infoText{
      margin: 0 0 10px;
      font-size: 12.5px;
      line-height: 1.55;
      color: var(--muted);
    }
    .infoList{
      margin: 0;
      padding-left: 18px;
      color: var(--muted);
      font-size: 12.5px;
      line-height: 1.55;
    }
    .infoList b{ color: var(--text); font-weight: 750; }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card" role="application" aria-label="Web Calculator">
      <header>
        <div class="title">Web Calculator</div>
        <div class="hint">Keyboard supported</div>
      </header>
      <div class="display" aria-live="polite">
        <div class="expression" id="expr"></div>
        <div class="value" id="value">0</div>
      </div>

      <div class="keys">
        <button class="op" data-k="C">C</button>
        <button class="op" data-k="back">⌫</button>
        <button class="op" data-k="%">%</button>
        <button class="op" data-k="/">÷</button>

        <button data-k="7">7</button>
        <button data-k="8">8</button>
        <button data-k="9">9</button>
        <button class="op" data-k="*">×</button>

        <button data-k="4">4</button>
        <button data-k="5">5</button>
        <button data-k="6">6</button>
        <button class="op" data-k="-">−</button>

        <button data-k="1">1</button>
        <button data-k="2">2</button>
        <button data-k="3">3</button>
        <button class="op" data-k="+">+</button>

        <button class="wide" data-k="0">0</button>
        <button data-k=".">.</button>
        <button class="accent" data-k="=">=</button>
      </div>
      
      <!-- Description (SEO + UX) -->
      <section class="info" aria-label="About this calculator">
        <h1 class="infoTitle">Web Calculator</h1>
        <p class="infoText">
          A fast, free web calculator for everyday arithmetic. Supports keyboard input, percentage,
          decimals, and continuous calculations. Works smoothly on desktop and mobile.
        </p>
        <ul class="infoList">
          <li><b>Keyboard:</b> type numbers and operators, press <b>Enter</b> for equals</li>
          <li><b>Clear:</b> <b>Esc</b> clears all, <b>Backspace</b> deletes one digit</li>
        </ul>
      </section>
      
      <footer>
        Example: <code>12.5*3-4</code> · Safe expression parser (no eval)
        <a href="/about/">About</a> ·
        <a href="/privacy/">Privacy</a> ·
        <a href="/contact/">Contact</a>
      </footer>
      
    </div>
  </div>

<script>
(() => {
  const exprEl = document.getElementById("expr");
  const valueEl = document.getElementById("value");

  let expr = "";
  let current = "0";
  let lastWasEqual = false;
  let startNewNumber = false; // next digit starts a new number

  let repeatOp = null;     // '+', '-', '*', '/'
  let repeatVal = null;    // number


  const isOp = c => ["+","-","*","/"].includes(c);

  function update() {
    exprEl.textContent = expr;
    valueEl.textContent = current;
  }

  function clearAll() {
    repeatOp = null;
    repeatVal = null;
    expr = "";
    current = "0";
    lastWasEqual = false;
    startNewNumber = false;
    update();
  }

  function backspace() {
    if (lastWasEqual) return clearAll();
    if (current.length <= 1 || (current.length === 2 && current.startsWith("-"))) {
      current = "0";
    } else {
      current = current.slice(0, -1);
    }
    update();
  }

  function appendDigit(d) {
    if (lastWasEqual) {
      expr = "";
      lastWasEqual = false;
      // keep current as result until user starts typing; then overwrite
      startNewNumber = true;
    }

    if (current === "Error") {
      clearAll();
    }

    // If we are starting a new number (after operator or after equals), overwrite
    if (startNewNumber) {
      current = (d === ".") ? "0." : d;
      startNewNumber = false;
      update();
      return;
    }

    if (d === "." && current.includes(".")) return;
    if (current === "0" && d !== ".") current = d;
    else current += d;
    update();
  }

  function appendOperator(op) {
    repeatOp = null;
    repeatVal = null;

    // If user just pressed "=", continue from current result
    if (lastWasEqual) lastWasEqual = false;

    // exprが空の場合は current を先頭へ
    if (!expr) {
      expr = current + " " + op + " ";
      startNewNumber = true;
      update();
      return;
    }

    const trimmed = expr.trimEnd();

    // 末尾が演算子なら置換
    if (isOp(trimmed.slice(-1))) {
      expr = trimmed.slice(0, -1) + op + " ";
      startNewNumber = true;
      update();
      return;
    }

    // 通常：current を確定して演算子
    expr += current + " " + op + " ";
    startNewNumber = true;     // ← ここがポイント（表示は変えない）
    update();
  }

  function percent() {
    const x = Number(current);
    if (!Number.isFinite(x)) return;
    current = String(x / 100);
    update();
  }

  function evaluateExpression(s) {
    const tokens = s.match(/-?\d+(?:\.\d+)?|[+\-*/]/g);
    if (!tokens) return NaN;

    const output = [];
    const ops = [];
    const prec = {"+":1,"-":1,"*":2,"/":2};

    for (const t of tokens) {
      if (/^-?\d/.test(t)) output.push(Number(t));
      else {
        while (ops.length && prec[ops[ops.length-1]] >= prec[t]) {
          output.push(ops.pop());
        }
        ops.push(t);
      }
    }
    while (ops.length) output.push(ops.pop());

    const stack = [];
    for (const t of output) {
      if (typeof t === "number") stack.push(t);
      else {
        const b = stack.pop();
        const a = stack.pop();
        if (a === undefined || b === undefined) return NaN;
        if (t === "+") stack.push(a + b);
        if (t === "-") stack.push(a - b);
        if (t === "*") stack.push(a * b);
        if (t === "/") stack.push(a / b);
      }
    }
    return stack.length === 1 ? stack[0] : NaN;
  }
  function extractLastBinaryOp(fullExpr) {
    // fullExpr example: "5 + 2 * 3"
    const tokens = fullExpr.match(/-?\d+(?:\.\d+)?|[+\-*/]/g);
    if (!tokens || tokens.length < 3) return null;

    // find last pattern: <number> <op> <number> (at the end)
    // tokens ends with number, find nearest operator before it
    const lastNumStr = tokens[tokens.length - 1];
    const lastNum = Number(lastNumStr);
    if (!Number.isFinite(lastNum)) return null;

    for (let i = tokens.length - 2; i >= 0; i--) {
      const t = tokens[i];
      if (["+","-","*","/"].includes(t)) {
        return { op: t, val: lastNum };
      }
    }
    return null;
  }

  function applyOp(a, op, b) {
    if (!Number.isFinite(a) || !Number.isFinite(b)) return NaN;
    if (op === "+") return a + b;
    if (op === "-") return a - b;
    if (op === "*") return a * b;
    if (op === "/") return a / b;
    return NaN;
  }

  function equals() {
    // If user presses "=" repeatedly, repeat last operation
    if (lastWasEqual) {
      const a = Number(current);
      if (repeatOp && repeatVal !== null && Number.isFinite(a)) {
        const r = applyOp(a, repeatOp, repeatVal);
        expr = `${a} ${repeatOp} ${repeatVal} =`;
        current = Number.isFinite(r)
          ? String(Math.round((r + Number.EPSILON) * 1e12) / 1e12)
          : "Error";
        update();
      }
      return;
    }

    if (!expr) return;

    const full = expr.trim() + " " + current;
    const result = evaluateExpression(full);

    // store repeat operation (last operator + last number)
    const last = extractLastBinaryOp(full);
    repeatOp = last ? last.op : null;
    repeatVal = last ? last.val : null;

    expr = full + " =";
    if (!Number.isFinite(result)) current = "Error";
    else current = String(Math.round((result + Number.EPSILON) * 1e12) / 1e12);

    lastWasEqual = true;
    update();
  }

  function handle(k) {
    if (k === "C") return clearAll();
    if (k === "back") return backspace();
    if (k === "%") return percent();
    if (k === "=") return equals();
    if (isOp(k)) return appendOperator(k);
    if (k === "." || /^\d$/.test(k)) return appendDigit(k);
  }
  
  document.querySelectorAll("button[data-k]").forEach(btn => {
    btn.addEventListener("pointerdown", (e) => {
      // prevent ghost clicks on mobile and make it feel instant
      e.preventDefault();
      handle(btn.dataset.k);
    });
  });

  window.addEventListener("keydown", e => {
    if (e.key === "Enter") return handle("=");
    if (e.key === "Backspace") return handle("back");
    if (e.key === "Escape") return handle("C");
    if (["+","-","*","/","."].includes(e.key)) return handle(e.key);
    if (/^\d$/.test(e.key)) return handle(e.key);
  });

  update();
})();
</script>
</body>
</html>
